2200-[节能开启]开关机状态恢复
==================================

    通用测试环境搭建，参考 :ref:`典型安装拓扑` , 测试过程可能用到以下辅助工具：
        * shell脚本
        * python脚本
        * apifox

    用例依赖 *id:0*

    概述:
        当系统处于节能开启期间，当控制器下发关机指令后，空调机应当处于关机状态，当控制器下发开机指令后，空调机应当处于开机状态。当空调机在一段时间内应当处于开机状态，由于认为操作导致空调机关机，
        此时空调机的工作状态和受控的状态不一致，对于此种情况，控制器具备以下能力:
            * 对工作状态不一致的情形进行了甄别。
            * 当发现不一致后，将反复发出指令，使得空调机工作在受控状态。

    本例测试环境
        * 参考\ :ref:`典型安装拓扑`, 搭建硬件环境。
        * 具备平台账号，所有设备已入平台。
        * 可加热到50℃以上的热源。

    前置条件
        #. 平台上对目标控制器，设置“节能开启”
        #. 设置节能模式的工作温度上限 27℃, 工作温度下限 20℃。(\ *此设置依据环境温度适当条长，目的在于使得环境温度处于二者之间*\  ) 。

    操作步骤
        #. 打开串口工具，调出控制器的日志输出。
        #. 参考 :ref:`ApiFox分合闸用例设置`, 设置测试用例。
        #. 开启控制器 ap :ref:`控制器AP开&关`, 将电脑wifi连接至控制器的ap ( SECO-AIRC-xxxx )。
        #. 单击步骤2中， ApiFox 中的 *运行* 按钮。 运行过程展示： :ref:`ApiFox分合闸用例执行过程`

---------

平台上勾选节能模式是否关机断电后，当空调工作温度低于工作温度下限值,空调关机并且在1分钟内采集器分闸。

此功能仅在节能开启时生效。

当节能开启时，自动关机或手动通过平台下发关机，此功能均生效。

举例: 关机后自动断电

平台设置空调机节能开启，工作上限27℃， 工作下限温度20℃，环境温度18℃（不会触发空调机自动运行）

平台设置空调机关机后断电(选中/使能)

开启热风直吹空调机回风温度传感器。

结果：
回风温度上升至27℃后，空调机启动。（节能控制）

回风温度下降至20℃后，空调机关机。（节能控制）

2后，开始计时，2分钟内（典型值）空调机将分闸断电。


以下为框架-为填充
-------------------





预期
    1. 步骤4后，apiFox 将每间隔20秒发送一次命令

        * 发送“分闸命令后”， 采集器能在10s内操作执行分闸动作。
        * 分闸同时，有清脆的 *哒* 声发出。
        * 分闸后观察采集器的 **分合** 灯, 绿色亮起。
    #. 发出合闸命令后

        * 发送“分闸命令后”， 采集器能在10s内操作执行合闸动作。
        * 合闸同时，有清脆的 *哒* 声发出。
        * 合闸后观察采集器的 **分合** 灯, 红色亮起。

结果

    * 回风温度升高至上限(36度)后，采集器自动合闸且开机制冷。
    * 开关机制冷过程，下发分闸指令后。待空调回风温度下降至 下限(18度)后，采集器先停机再分闸。如回风温度未达到 下限(18度)则不执行关机也不执行分闸。

备注
    暂无